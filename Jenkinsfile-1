pipeline {
  agent { dockerfile true }
  stages {
    stage('Install Dependencies') {
            steps {
                script {
                    sh 'python3 -m venv venv'
                    sh '. venv/bin/activate'
                    sh 'export ANSIBLE_TMPDIR="/tmp/ansible_tmp"'
                    sh 'export PIP_CACHE_DIR="/tmp/pip_cache"'
              }
          }
      }

    stage('Version Check') {
      steps {
        sh '''
          python3 --version
          pip --version
          pip install ansible junit_xml pymongo xmljson jmespath kubernetes==12.0.1 openshift==0.12.1
          ansible --version
          ansible-playbook --version
        '''
      }
    }
  }
}
